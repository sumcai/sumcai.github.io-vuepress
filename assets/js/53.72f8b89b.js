(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{627:function(s,a,t){"use strict";t.r(a);var n=t(20),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"cmake-详解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cmake-详解"}},[s._v("#")]),s._v(" Cmake 详解")]),s._v(" "),t("p",[s._v("本文记录了"),t("code",[s._v("cmake")]),s._v("的用法。")]),s._v(" "),t("h2",{attrs:{id:"概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[s._v("#")]),s._v(" 概述")]),s._v(" "),t("h3",{attrs:{id:"cmake-是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cmake-是什么"}},[s._v("#")]),s._v(" cmake 是什么")]),s._v(" "),t("p",[t("code",[s._v("cmake")]),s._v("是一款优秀的工程构建工具。KDE 开发者在使用了近 10 年"),t("code",[s._v("autotools")]),s._v("之后，终于决定为"),t("code",[s._v("KDE4")]),s._v("选择一个新的工程构建工具。")]),s._v(" "),t("p",[s._v("特点:")]),s._v(" "),t("ul",[t("li",[s._v("开放源代码")]),s._v(" "),t("li",[s._v("跨平台，在"),t("code",[s._v("Linux/Unix")]),s._v("上，生成"),t("code",[s._v("makefile")]),s._v("；在"),t("code",[s._v("MacOS")]),s._v("上生成"),t("code",[s._v("xcode")]),s._v("；在"),t("code",[s._v("windows")]),s._v("上生成"),t("code",[s._v("MSVC")]),s._v("的工程文件")]),s._v(" "),t("li",[s._v("简化编译构建过程和编译过程，工具链简单"),t("code",[s._v("cmake + make")])]),s._v(" "),t("li",[s._v("高效，比"),t("code",[s._v("autotools")]),s._v("快"),t("code",[s._v("%40")]),s._v(",主要是因为在工具链中没有"),t("code",[s._v("libtool")])]),s._v(" "),t("li",[s._v("可拓展，可以为"),t("code",[s._v("cmake")]),s._v("编写特定功能的模块，扩充"),t("code",[s._v("cmake")]),s._v("功能")]),s._v(" "),t("li",[s._v("额外的构建目录树（采用外部构建），不用担心任何删除源码文件的风险")]),s._v(" "),t("li",[s._v("支持机器字节序以及其他硬件特性问题的测试")]),s._v(" "),t("li",[s._v("在大部分平台下支持并行构建和自动生成文件依赖")])]),s._v(" "),t("h3",{attrs:{id:"为什么选用-cmake"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#为什么选用-cmake"}},[s._v("#")]),s._v(" 为什么选用 cmake")]),s._v(" "),t("p",[s._v("为什么不用"),t("code",[s._v("autotools")]),s._v("?")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("autotools")]),s._v("在"),t("code",[s._v("windows")]),s._v("平台不友好")]),s._v(" "),t("li",[s._v("工具链太长，需要用户操作的地方太多")])]),s._v(" "),t("p",[s._v("为什么不采用"),t("code",[s._v("JAM")]),s._v("、"),t("code",[s._v("qmake")]),s._v("、"),t("code",[s._v("Scons")]),s._v(" 和 "),t("code",[s._v("ANT")]),s._v("？")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("qmake")]),s._v("是与"),t("code",[s._v("cmake")]),s._v("最相似的，尽管它缺少一些"),t("code",[s._v("CMake")]),s._v("中提供的一些系统适配的功能")]),s._v(" "),t("li",[t("code",[s._v("ANT")]),s._v("使用"),t("code",[s._v("xml")]),s._v("作为输入使其与传统的"),t("code",[s._v("makefile")]),s._v("区分开来")]),s._v(" "),t("li",[t("code",[s._v("JAM")]),s._v("用他自有的语言")]),s._v(" "),t("li",[t("code",[s._v("Scons")]),s._v("使用的是"),t("code",[s._v("python")])]),s._v(" "),t("li",[s._v("这些工具中的几个直接调用编译器，而不是构建系统来直接处理这些构建任务。它们中的一些工具要求安装例如"),t("code",[s._v("python")]),s._v("和"),t("code",[s._v("Java")]),s._v("的第三方工具才能够正常工作。")])]),s._v(" "),t("h3",{attrs:{id:"安装-cmake"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装-cmake"}},[s._v("#")]),s._v(" 安装 cmake")]),s._v(" "),t("p",[s._v("直接去官网下载最新的源代码，然后执行:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./bootstrap --prefix"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"基本语法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基本语法"}},[s._v("#")]),s._v(" 基本语法")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("command"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arg1 arg2 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行命令")]),s._v("\nset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("var_name var_value"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义变量,或者给已经存在的变量赋值")]),s._v("\ncommand"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arg1 "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${var_name}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用变量")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 控制语句")]),s._v("\nIF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("expression"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    COMMAND1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ARGS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nELSE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("expression"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    COMMAND2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ARGS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nENDIF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("expression"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# expression")]),s._v("\nIF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("var"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不是空, 0, N, NO, OFF, FALSE, NOTFOUND 或 <var>_NOTFOUND时，为真")]),s._v("\nIF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NOT var"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 与上述条件相反。")]),s._v("\nIF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("var1 AND var2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当两个变量都为真是为真。")]),s._v("\nIF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("var1 OR var2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当两个变量其中一个为真时为真。")]),s._v("\nIF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("COMMAND cmd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当给定的cmd确实是命令并可以调用是为真")]),s._v("\nIF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("EXISTS "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("dir")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 目录名存在")]),s._v("\nIF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("EXISTS "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文件名存在")]),s._v("\nIF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("IS_DIRECTORY "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("dirname")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当dirname是目录")]),s._v("\nIF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file1 IS_NEWER_THAN file2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当file1比file2新,为真")]),s._v("\nIF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("variable MATCHES regex"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 符合正则")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 循环")]),s._v("\nWHILE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("condition"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    COMMAND1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ARGS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    // "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nENDWHILE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("condition"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nAUX_SOURCE_DIRECTORY"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(". SRC_LIST"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nFOREACH"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("one_dir "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${SRC_LIST}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    MESSAGE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${one_dir}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nENDFOREACH"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("onedir"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br")])]),t("p",[s._v("在项目的每个目录中，都需要编写一个"),t("code",[s._v("CMakeLists.txt")]),s._v("。")]),s._v(" "),t("h2",{attrs:{id:"hello-cmake-例子"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hello-cmake-例子"}},[s._v("#")]),s._v(" hello cmake 例子")]),s._v(" "),t("p",[s._v("准备好下面两个文件。")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// cmake-demo/main.c")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" argc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello cmake!\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// cmake-demo/CMakeLists.txt")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("PROJECT")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HELLO"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SET")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SRC_LIST main"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ADD_EXECUTABLE")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("SRC_LIST"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"内部构建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#内部构建"}},[s._v("#")]),s._v(" 内部构建")]),s._v(" "),t("p",[s._v("在"),t("code",[s._v("cmake-demo")]),s._v("目录下执行:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("cmake "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("就可以看到"),t("code",[s._v("cmake")]),s._v("为项目生产的"),t("code",[s._v("Makefile")]),s._v("文件，以及一些"),t("code",[s._v("cmake")]),s._v("缓存文件。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"外部构建"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#外部构建"}},[s._v("#")]),s._v(" 外部构建")]),s._v(" "),t("p",[s._v("内部构建生成的"),t("code",[s._v("Cmake")]),s._v("的中间文件与源代码文件混杂在一起，并且"),t("code",[s._v("cmake")]),s._v("没有提供清理这些中间文件的命令。")]),s._v(" "),t("p",[s._v("所以"),t("code",[s._v("cmake")]),s._v("推荐使用外部构建，步骤如下:")]),s._v(" "),t("ol",[t("li",[s._v("在"),t("code",[s._v("CMakeLists.txt")]),s._v("的同级目录下，新建一个"),t("code",[s._v("build")]),s._v("文件夹")]),s._v(" "),t("li",[s._v("进入"),t("code",[s._v("build")]),s._v("文件夹，执行"),t("code",[s._v("cmake ..")]),s._v("命令，这样所有的中间文件以及"),t("code",[s._v("Makefile")]),s._v("都在"),t("code",[s._v("build")]),s._v("目录下了")]),s._v(" "),t("li",[s._v("在"),t("code",[s._v("build")]),s._v("目录下执行"),t("code",[s._v("make")]),s._v("就可以得到可执行文件")])]),s._v(" "),t("h2",{attrs:{id:"从-hello-cmake-到项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#从-hello-cmake-到项目"}},[s._v("#")]),s._v(" 从 hello cmake 到项目")]),s._v(" "),t("h3",{attrs:{id:"多个源代码文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#多个源代码文件"}},[s._v("#")]),s._v(" 多个源代码文件")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n├── build                   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建目录")]),s._v("\n├── CMakeLists.txt          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 主CMakeLists.txt")]),s._v("\n├── main.c                  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 入口源文件")]),s._v("\n└── mod1                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 模块1")]),s._v("\n    ├── mod1.c\n    ├── mod1_func.c\n    ├── mod1_func.h\n    └── mod1.h\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// main.c")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mod1/mod1.h"')])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" argc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mod1_process")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// mod1.h")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("ifndef")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[s._v("__MOD1_H__")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("__MOD1_H__")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" GLOBAL_MOD1_VAR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mod1_process")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// mod1.c")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mod1.h"')])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mod1_func.h"')])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("unsigned")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" GLOBAL_MOD1_VAR "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mod1_process")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mod1_func")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// mod1_func.h")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("ifndef")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[s._v("__MOD1_FUNC_H__")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("__MOD1_FUNC_H__")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mod1_func")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// mod1_func.c")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mod1.h"')])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mod1_func.h"')])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mod1_func")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mod1: %d \\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" GLOBAL_MOD1_VAR "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br")])]),t("p",[s._v("本项目只有一个入口"),t("code",[s._v("main.c")]),s._v("文件，然后就是多个模块的源代码文件。一个主"),t("code",[s._v("CMakeLists.txt")]),s._v("也可管理好:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("cmake_minimum_required"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("VERSION "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nPROJECT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PROJECT_ONE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nadd_executable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main main.c mod1/mod1.c mod1/mod1_func.c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指明需要的源代码文件就好")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"将-mod1-模块作为动态库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#将-mod1-模块作为动态库"}},[s._v("#")]),s._v(" 将 mod1 模块作为动态库")]),s._v(" "),t("p",[s._v("对于上述文件，如果想让"),t("code",[s._v("mod1")]),s._v("独立编译，然后再链接进入可执行文件。则需要做出的修改如下:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n├── build\n├── CMakeLists.txt          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改")]),s._v("\n├── main.c\n└── mod1\n    ├── CMakeLists.txt      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增")]),s._v("\n    ├── mod1.c\n    ├── mod1_func.c\n    ├── mod1_func.h\n    └── mod1.h\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./CMakeLists.txt")]),s._v("\ncmake_minimum_required"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("VERSION "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nPROJECT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PROJECT_ONE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nadd_subdirectory"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod1 lib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加一个模块，并且将编译好库文件放置在 build/lib 目录")]),s._v("\nadd_executable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main main.c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ntarget_link_libraries"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main mod1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 链接 mod1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./mod1/CMakeLists.txt")]),s._v("\nadd_library"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod1 SHARED mod1.c mod1_func.c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成动态库 libmod1.so")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"mod1-依赖静态库-mod2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mod1-依赖静态库-mod2"}},[s._v("#")]),s._v(" mod1 依赖静态库 mod2")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n├── build\n├── CMakeLists.txt\n├── main.c\n└── mod1\n    ├── CMakeLists.txt          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改")]),s._v("\n    ├── mod1.c\n    ├── mod1_func.c             "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改，里面用到了 mod2 中的函数")]),s._v("\n    ├── mod1_func.h\n    ├── mod1.h\n    └── mod2                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增")]),s._v("\n        ├── CMakeLists.txt\n        ├── mod2.c\n        └── mod2.h\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[s._v("代码改动:")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ./mod1/mod1_func.c")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mod1.h"')])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mod1_func.h"')])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mod2/mod2.h"')]),s._v("          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 新增")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mod1_func")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mod2_func")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 新增")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mod1: %d \\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" GLOBAL_MOD1_VAR "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ./mod1/mod2/mod2.h")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("ifndef")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[s._v("__MOD2_H__")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("define")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token macro-name"}},[s._v("__MOD2_H__")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mod2_func")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")])]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ./mod1/mod2/mod2.c")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mod2.h"')])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mod2_func")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("fprintf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("stdout")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"call mod2 func\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[t("code",[s._v("main.c")]),s._v("没有直接用到"),t("code",[s._v("mod2")]),s._v("的，所以主"),t("code",[s._v("CMakeLists.txt")]),s._v("保持不变。"),t("code",[s._v("mod1")]),s._v("依赖"),t("code",[s._v("mod2")]),s._v("，所以由"),t("code",[s._v("mod1")]),s._v("的"),t("code",[s._v("CMakeLists.txt")]),s._v("负责"),t("code",[s._v("mod2")]),s._v("模块。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mod1/CMakeLists.txt")]),s._v("\nadd_subdirectory"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod2 mo2_lib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增 mod2 模块,　编译好的库置于 build/lib/mod2_lib　中")]),s._v("\nlink_directories"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod2_lib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加链接器的查找路径 build/lib/mod2_lib")]),s._v("\nadd_library"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod1 SHARED mod1.c mod1_func.c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成动态库 libmod1.so")]),s._v("\ntarget_link_libraries"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod1 mod2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将 libmod2.a 链接进入 libmod1.so 中")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mod1/mod2/CMakeLists.txt")]),s._v("\nadd_library"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod2 STATIC mod2.c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成静态库 libmod2.a")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("思考下下列 4 种依赖关系:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("main -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" libmod1.so -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" libmod2.a\nmain -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" libmod1.a  -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" libmod2.a\nmain -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" libmod1.so -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" libmod2.so\nmain -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" libmod1.a  -"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" libmod2.so\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("ul",[t("li",[s._v("对于底层是"),t("code",[s._v("libmod2.a")]),s._v("的情况，所有的实现代码都已经打包进入"),t("code",[s._v("libmod1")]),s._v("中，所以"),t("code",[s._v("libmod2.a")]),s._v("在最终生成"),t("code",[s._v("main")]),s._v("后，可以删除")]),s._v(" "),t("li",[s._v("对于底层是"),t("code",[s._v("libmod2.so")]),s._v("的情况，打包进入"),t("code",[s._v("libmod1")]),s._v("中的全部都是符号表，所以要保证"),t("code",[s._v("libmod2.so")]),s._v("的存在，并且正确链接到"),t("code",[s._v("main")]),s._v("了")])]),s._v(" "),t("h3",{attrs:{id:"如何支持-make-install-操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如何支持-make-install-操作"}},[s._v("#")]),s._v(" 如何支持 make install 操作")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n├── build\n├── CMakeLists.txt          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改")]),s._v("\n├── doc                     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增")]),s._v("\n│   └── release_note.txt\n├── main.c\n└── mod1\n    ├── CMakeLists.txt      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改")]),s._v("\n    ├── mod1.c\n    ├── mod1_func.c\n    ├── mod1_func.h\n    ├── mod1.h\n    └── mod2\n        ├── CMakeLists.txt  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改")]),s._v("\n        ├── mod2.c\n        └── mod2.h\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("各个目录的"),t("code",[s._v("CMakeLists.txt")]),s._v("各自负责自己目录下要安装的文件:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./CMakeLists.txt")]),s._v("\ncmake_minimum_required"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("VERSION "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nPROJECT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PROJECT_ONE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nadd_subdirectory"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod1 lib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加一个模块，并且将编译好库文件放置在 build/lib 目录")]),s._v("\nadd_executable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main main.c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ntarget_link_libraries"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main mod1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 链接 mod1")]),s._v("\n\nset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CMAKE_INSTALL_PREFIX "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ENV")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/usr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装路径前缀 /home/cao/usr")]),s._v("\ninstall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DIRECTORY doc/ DESTINATION share/PROJECT_ONE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装项目文档")]),s._v("\ninstall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TARGETS main RUNTIME DESTINATION bin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# main 安装到 usr/bin")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./mod1/CMakeLists.txt")]),s._v("\nadd_subdirectory"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod2 mo2_lib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增 mod2 模块,　编译好的库置于 build/lib/mod2_lib　中")]),s._v("\nlink_directories"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod2_lib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加链接器的查找路径 build/lib/mod2_lib")]),s._v("\nadd_library"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod1 SHARED mod1.c mod1_func.c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成动态库 libmod1.so")]),s._v("\ntarget_link_libraries"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod1 mod2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将 libmod2.a 链接进入 libmod1.so 中")]),s._v("\n\ninstall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TARGETS mod1 LIBRARY DESTINATION lib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装到 usr/lib")]),s._v("\ninstall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FILES mod1.h DESTINATION include/mod1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装到 usr/include/mod1")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./mod1/mod2/CMakeLists.txt")]),s._v("\nadd_library"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod2 SHARED mod2.c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成静态库 libmod2.a")]),s._v("\ninstall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TARGETS mod2 LIBRARY DESTINATION lib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装到 usr/lib")]),s._v("\ninstall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FILES mod2.h DESTINATION include/mod2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装到 usr/include/mod2")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("h3",{attrs:{id:"添加一个-find-模块"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加一个-find-模块"}},[s._v("#")]),s._v(" 添加一个 Find 模块")]),s._v(" "),t("p",[s._v("其实纯粹依靠"),t("code",[s._v("cmake")]),s._v("本身提供的基本指令来管理工程是一件非常复杂的事情，所以"),t("code",[s._v("cmake")]),s._v("设计成了可扩展的架构，可以通过编写一些通用的模块来扩展"),t("code",[s._v("cmake")]),s._v("。这便是"),t("code",[s._v("Finder")]),s._v("功能，对于"),t("code",[s._v("linux")]),s._v("里一些常用的内置库，"),t("code",[s._v("cmake")]),s._v("也预先提供了这样模块，比如"),t("code",[s._v("FindCURL")]),s._v("、"),t("code",[s._v("FindCurses")]),s._v("、"),t("code",[s._v("FindImageMagick")]),s._v("模块。在"),t("code",[s._v("CMakeLists.txt")]),s._v("里的使用如下:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("find_package"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CURL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nif"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CURL_FOUND"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    include_directories"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CURL_INCLUDE_DIR}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    add_executable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("curltest main.c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    target_link_libraries"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("curltest "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CURL_LIBRARY}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nelse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CURL_FOUND"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FATAL_ERROR "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"curl library not found"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nendif"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CURL_FOUND"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("那么对于"),t("code",[s._v("cmake")]),s._v("没有提供"),t("code",[s._v("Find")]),s._v("模块的第三方库，我们该如何实现这一功能呢？下面以"),t("code",[s._v("hiredis")]),s._v("库（一个流行的操作"),t("code",[s._v("Redis")]),s._v("的"),t("code",[s._v("C")]),s._v("库）举例。")]),s._v(" "),t("p",[s._v("首先，我们先安装好它:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://github.com/redis/hiredis/archive/v0.14.0.tar.gz "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载最新发布版")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf v0.14.0.tar.gz                                     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" hiredis-0.14.0\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("                                                         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译，在本目录下得到 libhiredis.so")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 执行结果")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /usr/local/include/hiredis /usr/local/include/hiredis/adapters /usr/local/lib\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -pPR hiredis.h async.h read.h sds.h /usr/local/include/hiredis\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -pPR adapters/*.h /usr/local/include/hiredis/adapters\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -pPR libhiredis.so /usr/local/lib/libhiredis.so.0.14\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/lib "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -sf libhiredis.so.0.14 libhiredis.so\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -pPR libhiredis.a /usr/local/lib\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /usr/local/lib/pkgconfig\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -pPR hiredis.pc /usr/local/lib/pkgconfig\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("从上面的安装结果来看:")]),s._v(" "),t("ul",[t("li",[s._v("头文件在"),t("code",[s._v("/usr/local/include/hiredis/hiredis.h")]),s._v(",所以程序里需要"),t("code",[s._v("#include <hiredis/hiredis.h>")])]),s._v(" "),t("li",[s._v("库文件在"),t("code",[s._v("/usr/local/lib")]),s._v("中,库名为"),t("code",[s._v("hiredis")])])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n├── build\n├── cmake                   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增")]),s._v("\n│   └── FindHIREDIS.cmake   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# FindHIREDIS 模块")]),s._v("\n├── CMakeLists.txt          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改")]),s._v("\n├── doc\n│   └── release_note.txt\n├── main.c                  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改")]),s._v("\n└── mod1\n    ├── CMakeLists.txt\n    ├── mod1.c\n    ├── mod1_func.c\n    ├── mod1_func.h\n    ├── mod1.h\n    └── mod2\n        ├── CMakeLists.txt\n        ├── mod2.c\n        └── mod2.h\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("p",[s._v("源代码的修改,添加使用例子 :")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<hiredis/hiredis.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mod1/mod1.h"')])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" argc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mod1_process")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    redisContext "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("conn "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("redisConnect")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"127.0.0.1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6379")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" conn "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("NULL")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" conn"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("err "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"连接失败:%s\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" conn"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("errstr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    redisReply "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("reply "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("redisReply"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("redisCommand")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("conn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"set foo 1234"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("freeReplyObject")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reply"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    reply "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("redisCommand")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("conn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"get foo"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"%s\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("reply"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),s._v("str"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("freeReplyObject")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reply"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("redisFree")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("conn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br")])]),t("p",[s._v("自定义"),t("code",[s._v("FindHIREDIS")]),s._v("模块:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("find_path"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HIREDIS_INCLUDE_DIR hiredis.h /usr/local/include/hiredis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nfind_library"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HIREDIS_LIBRARY NAMES hiredis "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v(" /usr/local/lib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nif"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HIREDIS_INCLUDE_DIR AND HIREDIS_LIBRARY"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    SET"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HIREDIS_FOUND TRUE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nendif"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HIREDIS_INCLUDE_DIR AND HIREDIS_LIBRARY"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nif"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HIREDIS_FOUND"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    if"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NOT HIREDIS_FIND_QUIETLY"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Found Hello: '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HIREDIS_LIBRARY}")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    endif"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("NOT HIREDIS_FIND_QUIETLY"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nelse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HIREDIS_FOUND"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    if"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HIREDIS_FIND_REQUIRED"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FATAL_ERROR "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Could not find hello library"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    endif"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HIREDIS_FIND_REQUIRED"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nendif"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HIREDIS_FOUND"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br")])]),t("p",[s._v("修改主"),t("code",[s._v("CMakeLists.txt")]),s._v("为:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("cmake_minimum_required"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("VERSION "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nPROJECT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PROJECT_ONE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nadd_subdirectory"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod1 lib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nadd_executable"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main main.c"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ntarget_link_libraries"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main mod1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CMAKE_MODULE_PATH "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PROJECT_SOURCE_DIR}")]),s._v("/cmake"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置自定义 Find module 的路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 连接 libhiredis.so")]),s._v("\nfind_package"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HIREDIS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nif"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HIREDIS_FOUND"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    include_directories"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HIREDIS_INCLUDE_DIR}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    target_link_libraries"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("main "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${HIREDIS_LIBRARY}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nelse"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HIREDIS_FOUND"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("FATAL_ERROR "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"libhiredis.so not be found!"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nendif"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("HIREDIS_FOUND"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CMAKE_INSTALL_PREFIX "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ENV")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("/usr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ninstall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("DIRECTORY doc/ DESTINATION share/PROJECT_ONE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ninstall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("TARGETS main RUNTIME DESTINATION bin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("h3",{attrs:{id:"传递给源代码一些配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#传递给源代码一些配置"}},[s._v("#")]),s._v(" 传递给源代码一些配置")]),s._v(" "),t("p",[s._v("在"),t("code",[s._v("CMakeLists.txt")]),s._v("中配置参数，控制源代码中代码的编译部分，比如可以通过一个参数控制，是用自己写的库还是系统库？")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n├── build\n├── cmake\n│   └── FindHIREDIS.cmake\n├── cmakeconfig.h.in            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 新增")]),s._v("\n├── CMakeLists.txt              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改")]),s._v("\n├── doc\n│   └── release_note.txt\n├── main.c                      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改")]),s._v("\n└── mod1\n    ├── CMakeLists.txt\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("p",[s._v("在主"),t("code",[s._v("CMakeLists.txt")]),s._v("里定义:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("cmake_minimum_required"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("VERSION "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nPROJECT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PROJECT_ONE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过 cmakeconfig.h 传递参数给源文件")]),s._v("\nset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("AUTHOR "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"codekissyoung"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("RELEASE_DATE "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2019-6-25"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("USE_MY_LIB "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"1"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                                  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用自己的库")]),s._v("\nconfigure_file"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PROJECT_SOURCE_DIR}")]),s._v("/cmakeconfig.h.in\n    "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PROJECT_BINARY_DIR}")]),s._v("/cmakeconfig.h\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\ninclude_directories"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${PROJECT_BINARY_DIR}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nadd_subdirectory"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod1 lib"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加模块，编译后放在 build/lib")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("再定义"),t("code",[s._v("cmakeconfig.h.in")]),s._v(",它会在"),t("code",[s._v("Build")]),s._v("目录里生成一个"),t("code",[s._v("cmakeconfig.h")]),s._v("，"),t("code",[s._v("@@")]),s._v("中间的名字会被替换:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#define AUTHOR "@AUTHOR@"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#define RELEASE_DATE "@RELEASE_DATE@"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('#define USE_MY_LIB "@USE_MY_LIB@"')]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("再看下源代码中如何使用:")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<stdio.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("<hiredis/hiredis.h>")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cmakeconfig.h"')]),s._v("                    "),t("span",{pre:!0,attrs:{class:"token expression"}},[s._v("# 这里引用 cmakeconfig"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("h")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("include")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mod1/mod1.h"')])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" argc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("char")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("argv"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"author: %s, release_date: %s\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" AUTHOR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" RELEASE_DATE "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("ifdef")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[s._v("USE_MY_LIB")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"使用自己的库的代码\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("else")])]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"使用系统库的代码\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")])]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mod1_process")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h3",{attrs:{id:"区分-开发版-与-发布版"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#区分-开发版-与-发布版"}},[s._v("#")]),s._v(" 区分 开发版 与 发布版")]),s._v(" "),t("p",[s._v("上述的代码编译后都是不可调试的，并且没有做编译优化，我们希望能够编译成一个调试版本与一个发布版本。做法如下:")]),s._v(" "),t("ul",[t("li",[s._v("我们将"),t("code",[s._v("build")]),s._v("目录作为开发版本编译目录，与之相对的新建一个"),t("code",[s._v("release")]),s._v("目录作为发布版本")]),s._v(" "),t("li",[s._v("在"),t("code",[s._v("build")]),s._v("目录下我们执行"),t("code",[s._v("cmake -DMAKE_BUILD_TYPE=Debug ..")]),s._v(",编译命令会使用"),t("code",[s._v("-g")])]),s._v(" "),t("li",[s._v("在"),t("code",[s._v("release")]),s._v("目录下我们执行"),t("code",[s._v("cmake -DMAKE_BUILD_TYPE=Release ..")]),s._v(",编译命令会使用"),t("code",[s._v("-O3 -DNDEBUG")])])]),s._v(" "),t("p",[s._v("所以，在源代码中，我们可以使用"),t("code",[s._v("NDEBUG")]),s._v("宏来控制，在开发版输出调试信息，而在发布版本去掉调试信息。")]),s._v(" "),t("div",{staticClass:"language-c line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-c"}},[t("code",[t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("ifndef")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[s._v("NDEBUG")])]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("printf")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"author: %s, release_date: %s\\n"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" AUTHOR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" RELEASE_DATE "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" # 只在开发版本编译\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("我自己在写代码的时候，习惯在开发版本打开所有的错误报告，而上述的开发版本只使用了"),t("code",[s._v("-g")]),s._v("，这显然是不够的，需要通过在"),t("code",[s._v("CMakeLists.txt")]),s._v("里重新设置下开发版本的编译参数:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("cmake_minimum_required"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("VERSION "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nPROJECT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PROJECT_ONE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nset"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("CMAKE_C_FLAGS_DEBUG "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-g -Wall -pedantic -DDEBUG"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"debug flags: '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_C_FLAGS_DEBUG}")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"release flags: '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_C_FLAGS_RELEASE}")]),s._v('"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("通常我习惯使用脚本来完成重复的"),t("code",[s._v("构建-编译-运行")]),s._v("这一过程，参考如下:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./make-debug.sh")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf build/*                                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 清理上一次的结果")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" build "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" cmake -DCMAKE_BUILD_TYPE"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("debug "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入debug目录，执行构建")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" ./main                                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译，然后运行")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./make-release.sh\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf release/*                                  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 清理上一次的结果")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" release "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" cmake -DCMAKE_BUILD_TYPE"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("release "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入release目录，执行构建")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" ./main                                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译，然后运行")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"总结-one-project-项目"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#总结-one-project-项目"}},[s._v("#")]),s._v(" 总结 ONE_PROJECT 项目")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n├── build\n├── cmake\n│   └── FindHIREDIS.cmake\n├── doc\n│   └── release_note.txt\n├── mod1\n│   ├── mod2\n│   │   ├── CMakeLists.txt\n│   │   ├── mod2.c\n│   │   └── mod2.h\n│   ├── CMakeLists.txt\n│   ├── mod1.c\n│   ├── mod1_func.c\n│   ├── mod1_func.h\n│   └── mod1.h\n├── release\n├── cmakeconfig.h.in\n├── CMakeLists.txt\n├── main.c\n├── make-debug.sh\n└── make-release.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br")])]),t("p",[s._v("整个项目的目录结构如上,把这个项目作为脚手架，进行开发的话，非常容易就实现下面目标:")]),s._v(" "),t("ul",[t("li",[s._v("非常容易划分，添加项目自己实现的"),t("code",[s._v("mod")])]),s._v(" "),t("li",[s._v("非常容易通过"),t("code",[s._v("Find")]),s._v("功能引入第三方库")]),s._v(" "),t("li",[s._v("非常容易通过传递参数到 源代码 中，实现条件编译，比如选择使用　第三方库　还是 系统库　等")]),s._v(" "),t("li",[s._v("开发版本 与 发布版本 分离")])]),s._v(" "),t("h2",{attrs:{id:"指令参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#指令参考"}},[s._v("#")]),s._v(" 指令参考")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("PROJECT"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("projectname"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 项目名")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("SET"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("VAR "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("VALUE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("CACHE TYPE DOCSTRING "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("FORCE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("code",[s._v("SET")]),s._v("定义变量。使用变量则是"),t("code",[s._v("${VAR_NAME}")]),s._v("。注意：如果是在"),t("code",[s._v("IF")]),s._v("控制语句中，不能使用"),t("code",[s._v("${}")]),s._v("，而是直接使用"),t("code",[s._v("VAR_NAME")]),s._v("。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("MESSAGE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("SEND_ERROR "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" STATUS "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" FATAL_ERROR"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"message to display"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("code",[s._v("MESSAGE")]),s._v("向终端输出用户定义的信息，"),t("code",[s._v("FATAL_ERROR")]),s._v("会立即终止"),t("code",[s._v("cmake")]),s._v("编译过程。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("ADD_EXECUTABLE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exe "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${SRC_LIST}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("                     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成可执行文件 exe")]),s._v("\nADD_LIBRARY"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mod "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("SHARED"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("STATIC"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("MODULE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${SRC_LIST}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成库 libmod.so")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("ADD_SUBDIRECTORY"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("source_dir "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("binary_dir"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("EXCLUDE_FROM_ALL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("code",[s._v("ADD_SUBDIRECTORY")]),s._v("指定"),t("code",[s._v("cmake")]),s._v("子目录源代码所在路径，以及编译后二进制文件存放目录。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ENV")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("HOME")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用环境变量 HOME")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("INCLUDE_DIRECTORIES"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("header_file_dir"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加头文件搜索目录")]),s._v("\nLINK_DIRECTORIES"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("lib_file_dir"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("　　　         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加库文件搜索目录")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("TARGET_LINK_LIBRARIES"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("exe mod1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将 libmod1.so 链接到 exe 中")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("ADD_DEFINITIONS"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("-DENABLE_DEBUG"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("             "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 向C/C++编译器中添加宏定义 ENABLE_DEBUG")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("ADD_DEPENDENCIES"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("target-name depend-target1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 定义依赖")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("AUX_SOURCE_DIRECTORY"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(". SRC_LIST"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("code",[s._v("AUX_SOURCE_DIRECTORY")]),s._v("发现一个目录下所有的源代码文件并将列表存储在一个变量中。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("EXEC_PROGRAM"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ls ARGS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"*.c"')]),s._v(" OUTPUT_VARIABLE LS_OUTPUT RETURN_VALUE LS_RVALUE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nIF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("not LS_RVALUE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    MESSAGE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ls result: "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${LS_OUTPUT}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nENDIF"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("not LS_RVALUE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("code",[s._v("EXEC_PROGRAM")]),s._v("用于在构建时，运行"),t("code",[s._v("shell")]),s._v("命令，"),t("code",[s._v("ARGS")]),s._v("指明参数，"),t("code",[s._v("OUTPUT_VARIABLE")]),s._v(" "),t("code",[s._v("LS_OUTPUT")]),s._v(" "),t("code",[s._v("RETURN_VALUE")]),s._v(" "),t("code",[s._v("LS_RVALUE")]),s._v(" 存储了命令运行的结果。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("INCLUDE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("file1 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONAL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 载入 CMakeLists.txt　文件")]),s._v("\nINCLUDE"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("module "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OPTIONAL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("　　　 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 载入 cmake 模块")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[t("code",[s._v("OPTIONAL")]),s._v("参数的作用是文件不存在也不会产生错误。")]),s._v(" "),t("h2",{attrs:{id:"变量参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#变量参考"}},[s._v("#")]),s._v(" 变量参考")]),s._v(" "),t("p",[s._v("项目目录相关:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建发生的目录")]),s._v("\nCMAKE_BINARY_DIR\nPROJECT_BINARY_DIR\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("projectname"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_BINARY_DIR\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不论采用何种编译方式，都是工程顶层目录")]),s._v("\nCMAKE_SOURCE_DIR\nPROJECT_SOURCE_DIR\n"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("projectname"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("_SOURCE_DIR\n\nCMAKE_CURRENT_SOURCE_DIR  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当前处理的CMakeLists.txt所在的路径")]),s._v("\n\nCMAKE_CURRRENT_BINARY_DIR "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 内部编译: 跟CMAKE_CURRENT_SOURCE_DIR一致")]),s._v("\n                          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 外部编译: 指的是构建目录")]),s._v("\n                          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# add_subdirectory(src bin) 会更改它的值为 bin")]),s._v("\n\nCMAKE_CURRENT_LIST_FILE   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当前输出所在的CMakeLists.txt的完整路径")]),s._v("\nCMAKE_CURRENT_LIST_LINE   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当前输出所在的行")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("CMAKE_MODULE_PATH         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 模块所在路径")]),s._v("\n\nEXECUTABLE_OUTPUT_PATH    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可执行文件存放目录")]),s._v("\nLIBRARY_OUTPUT_PATH       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 库存放目录")]),s._v("\n\nCMAKE_INCLUDE_DIRECTORIES_PROJECT_BEFORE "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将工程提供的头文件目录始终置于系统头文件目录的前面")]),s._v("\n\nCMAKE_INCLUDE_PATH        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 头文件搜索目录")]),s._v("\n\nCMAKE_LIBRARY_PATH        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 库搜索目录")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("系统信息:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("CMAKE_MAJOR_VERSION       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CMAKE主版本号，比如2.4.6中的2")]),s._v("\nCMAKE_MINOR_VERSION       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CMAKE次版本号，比如2.4.6中的4")]),s._v("\nCMAKE_PATCH_VERSION       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CMAKE补丁等级，比如2.4.6中的6")]),s._v("\nCMAKE_SYSTEM              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 系统名称，比如Linux-2.6.22")]),s._v("\nCMAKE_SYSTEM_NAME         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 不包含版本的系统名，比如Linux")]),s._v("\nCMAKE_SYSTEM_VERSION      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 系统版本，比如2.6.22")]),s._v("\nCMAKE_SYSTEM_PROCESSOR    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 处理器名称，比如i686")]),s._v("\nUNIX                      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在所有的类Unix平台为TRUE，包括OSX和cygwin")]),s._v("\nWIN32                     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在所有的Win32平台为TRUE，包括cygwin")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("开关选项:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("CMAKE_ALLOW_LOOSE_LOOP_CONSTRUCTS   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 用来控制IF ELSE语句的书写方式")]),s._v("\nBUILD_SHARED_LIBS                   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个开关用来控制默认的库编译方式: 动态库 静态库")]),s._v("\nCMAKE_C_FLAGS                       "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置C编译选项")]),s._v("\nMAKE_CXX_FLAGS                      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# MAKE_CXX_FLAGS")]),s._v("\nCMAKE_INCLUDE_CURRENT_DIR           "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 自动将每个CMakeLists.txt的所在目录依次加入到 头文件搜索目录")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("编译参数相关:")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("message"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_C_FLAGS = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_C_FLAGS}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_C_FLAGS_DEBUG = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_C_FLAGS_DEBUG}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_C_FLAGS_RELEASE = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_C_FLAGS_RELEASE}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_CXX_FLAGS = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_CXX_FLAGS}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_CXX_FLAGS_DEBUG = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_CXX_FLAGS_DEBUG}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_CXX_FLAGS_RELEASE = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_CXX_FLAGS_RELEASE}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_EXE_LINKER_FLAGS = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_EXE_LINKER_FLAGS}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_EXE_LINKER_FLAGS_DEBUG = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_EXE_LINKER_FLAGS_DEBUG}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_EXE_LINKER_FLAGS_RELEASE = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_EXE_LINKER_FLAGS_RELEASE}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_SHARED_LINKER_FLAGS = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_SHARED_LINKER_FLAGS}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_SHARED_LINKER_FLAGS_DEBUG = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_SHARED_LINKER_FLAGS_DEBUG}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_SHARED_LINKER_FLAGS_RELEASE = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_SHARED_LINKER_FLAGS_RELEASE}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_STATIC_LINKER_FLAGS = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_STATIC_LINKER_FLAGS}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_STATIC_LINKER_FLAGS_DEBUG = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_STATIC_LINKER_FLAGS_DEBUG}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nmessage"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("STATUS "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"CMAKE_STATIC_LINKER_FLAGS_RELEASE = "')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${CMAKE_STATIC_LINKER_FLAGS_RELEASE}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("h2",{attrs:{id:"其他参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其他参考"}},[s._v("#")]),s._v(" 其他参考")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"http://www.hahack.com/codes/cmake/",target:"_blank",rel:"nofollow noopener noreferrer"}},[s._v("CMake 入门实战"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://www.cnblogs.com/Xiaoyan-Li/p/5674747.html",target:"_blank",rel:"nofollow noopener noreferrer"}},[s._v("CMake Official Tutorial——教程还是官方的好"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://blog.csdn.net/luanpeng825485697/article/details/81202136",target:"_blank",rel:"nofollow noopener noreferrer"}},[s._v("cmake 教程 基本语法"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);